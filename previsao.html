<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - Dark Style (Dados Fixos)</title>

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
    />
    <!-- Fonte Montserrat -->
    <link
      href="https://fonts.googleapis.com/css?family=Montserrat"
      rel="stylesheet"
    />
    <!-- Ícones FontAwesome -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />

    <!-- Estilos embutidos (dark style) -->
    <style>
      body {
        background: #1B213B;
        color: #777;
        font-family: Montserrat, Arial, sans-serif;
        margin: 0;
        padding: 0;
      }

      .content-area {
        max-width: 1280px;
        margin: 0 auto;
        padding: 20px;
      }

      .box {
        background-color: #262D47;
        padding: 25px;
        border-radius: 4px;
        margin-bottom: 30px;
      }

      h1, h2, h3, h4, h5, h6, strong {
        font-weight: 600;
      }

      /* Ajuste do tooltip no estilo dark */
      .box .apexcharts-xaxistooltip {
        background: #1B213B;
        color: #fff;
      }
    </style>
  </head>

  <body>
    <div class="content-area">
      <h1 class="text-center" style="color:#fff;">Relatório de Pagamentos</h1>
      <div class="box">
        <!-- Div onde o gráfico será renderizado -->
        <div id="chart"></div>
      </div>
    </div>

    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.slim.min.js"></script>
    <!-- Moment.js (opcional, caso queira manipular datas) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <!-- ApexCharts via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

    <script>
      // --------------------------------------------------------------------
      // 1) Configurações Globais do ApexCharts (tema dark, etc.)
      // --------------------------------------------------------------------
      window.Apex = {
        chart: {
          foreColor: '#fff',
          toolbar: { show: false },
        },
        colors: ['#FCCF31', '#17ead9', '#f02fc2'],
        stroke: { width: 3 },
        dataLabels: { enabled: false },
        grid: { borderColor: "#40475D" },
        xaxis: {
          axisTicks: { color: '#333' },
          axisBorder: { color: "#333" }
        },
        fill: {
          type: 'gradient',
          gradient: {
            gradientToColors: ['#F55555', '#6078ea', '#6094ea']
          },
        },
        tooltip: {
          theme: 'dark'
        },
        yaxis: {
          decimalsInFloat: 2,
          opposite: true,
          labels: { offsetX: -10 }
        }
      };

      // --------------------------------------------------------------------
      // 2) Seus dados (todos, inclusive FORNECEDOR, TRANSPORTADORA, RETIRADA etc.)
      // --------------------------------------------------------------------
      const dados = [
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "03/03/2025", valorPago: "R$ 28.478,55" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "03/03/2025", valorPago: "R$ 28.478,55" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "03/03/2025", valorPago: "R$ 28.478,55" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "03/03/2025", valorPago: "R$ 28.478,55" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "03/03/2025", valorPago: "R$ 28.478,55" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "12/03/2025", valorPago: "R$ 27.943,03" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "12/03/2025", valorPago: "R$ 27.943,03" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "12/03/2025", valorPago: "R$ 27.943,03" },
        { descricao: "GO SELL", categoria: "RETIRADA", dataPagamento: "20/02/2025", valorPago: "R$ 96.000,00" },
        { descricao: "GO SELL", categoria: "RETIRADA", dataPagamento: "20/03/2025", valorPago: "R$ 96.500,00" },
        { descricao: "BIGFER MATRIZ", categoria: "FORNECEDOR", dataPagamento: "22/03/2025", valorPago: "R$ 1.204,00" },
        { descricao: "MULTIVISAO INDUSTRIA E COMERCIO LTDA - OF", categoria: "FORNECEDOR", dataPagamento: "22/03/2025", valorPago: "R$ 26.153,60" },
        { descricao: "WIRUTEX", categoria: "FORNECEDOR", dataPagamento: "22/03/2025", valorPago: "R$ 2.841,95" },
        { descricao: "VERTICALPACK EMBALAGENS", categoria: "FORNECEDOR", dataPagamento: "22/03/2025", valorPago: "R$ 1.101,48" },
        { descricao: "VERTICAL PACK", categoria: "FORNECEDOR", dataPagamento: "22/03/2025", valorPago: "R$ 8.675,10" },
        { descricao: "MULTIVISÃO - OF LETS", categoria: "FORNECEDOR", dataPagamento: "22/03/2025", valorPago: "R$ 5.261,03" },
        { descricao: "MULTIVISÃO - OF LETS", categoria: "FORNECEDOR", dataPagamento: "22/03/2025", valorPago: "R$ 4.788,22" },
        { descricao: "MULTIVISÃO - PF - CAROÇO", categoria: "FORNECEDOR", dataPagamento: "22/03/2025", valorPago: "R$ 87.584,05" },
        { descricao: "MULTIVISAO INDUSTRIA E COMERCIO LTDA - OF", categoria: "FORNECEDOR", dataPagamento: "23/03/2025", valorPago: "R$ 26.863,15" },
        { descricao: "MULTIVISÃO - OF LETS", categoria: "FORNECEDOR", dataPagamento: "23/03/2025", valorPago: "R$ 2.902,58" },
        { descricao: "MULTIVISÃO - PF - CAROÇO", categoria: "FORNECEDOR", dataPagamento: "23/03/2025", valorPago: "R$ 25.315,09" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 27.943,03" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 27.943,03" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 27.943,03" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 27.943,03" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 27.943,03" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 27.943,03" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 27.943,03" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 27.943,03" },
        { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 27.943,03" },
        { descricao: "ARAUCO", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 67.943,01" },
        { descricao: "OR DESIGN", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 15.640,00" },
        { descricao: "ZAGA TRANS", categoria: "TRANSPORTADORA", dataPagamento: "24/03/2025", valorPago: "R$ 3.800,00" },
        { descricao: "ZAGA TRANS", categoria: "TRANSPORTADORA", dataPagamento: "24/03/2025", valorPago: "R$ 3.800,00" },
        { descricao: "PINHEIRO COMERCIO DE PAPEIS E EMBALAGENS LTDA", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 622,30" },
        { descricao: "LOTUS", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 8.827,50" },
        { descricao: "DZAINER", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 23.128,00" },
        { descricao: "DZAINER", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 22.400,00" },
        { descricao: "CIANURETO", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 6.207,00" },
        { descricao: "MB DECOR", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 15.905,00" },
        { descricao: "MB DECOR", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 4.800,00" },
        { descricao: "MB DECOR", categoria: "FORNECEDOR", dataPagamento: "24/03/2025", valorPago: "R$ 10.660,00" },
        { descricao: "ARGO PROVEDOR", categoria: "DESPESA FIXA", dataPagamento: "24/03/2025", valorPago: "R$ 259,80" },
        { descricao: "FUTURO LOG", categoria: "DESPESA FIXA", dataPagamento: "24/03/2025", valorPago: "R$ 6.000,00" },
        { descricao: "PINHEIRO COMERCIO DE PAPEIS E EMBALAGENS LTDA", categoria: "FORNECEDOR", dataPagamento: "25/03/2025", valorPago: "R$ 281,60" },
        { descricao: "XPTO ADMINISTRADORA DE BENS PROPRIOS LTDA", categoria: "DESPESA FIXA", dataPagamento: "25/03/2025", valorPago: "R$ 250,00" },
        { descricao: "ALUGUEL GIRUS 902 - MARCO ANTÔNIO", categoria: "DESPESA FIXA", dataPagamento: "25/03/2025", valorPago: "R$ 7.500,00" },
        { descricao: "ALUGUEL GIRUS  903 - LUCIANA BALAGUER", categoria: "DESPESA FIXA", dataPagamento: "25/03/2025", valorPago: "R$ 14.073,65" },
        { descricao: "ALUGUEL GIRUS  919 - VERA BALAGUER", categoria: "DESPESA FIXA", dataPagamento: "25/03/2025", valorPago: "R$ 14.073,65" },
        { descricao: "ARAUCO", categoria: "FORNECEDOR", dataPagamento: "25/03/2025", valorPago: "R$ 92.903,78" },
        { descricao: "ARAUCO", categoria: "FORNECEDOR", dataPagamento: "25/03/2025", valorPago: "R$ 113.238,35" },
        { descricao: "ISS - MADEIRA EXPRESS", categoria: "IMPOSTO", dataPagamento: "25/03/2025", valorPago: "R$ 1.891,86" },
        { descricao: "PRD_IMD NAVEGANTES", categoria: "FORNECEDOR", dataPagamento: "25/03/2025", valorPago: "R$ 29.000,00" },
        { descricao: "PAPAI NOEL", categoria: "IMPOSTO", dataPagamento: "25/03/2025", valorPago: "R$ 50.000,00" },
        { descricao: "CARLOS BALLOTIN", categoria: "RETIRADA", dataPagamento: "25/03/2025", valorPago: "R$ 50.000,00" },
        { descricao: "MARCELO ANTUNES", categoria: "RETIRADA", dataPagamento: "25/03/2025", valorPago: "R$ 50.000,00" },
        { descricao: "MULTIVISÃO - OF LETS", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 3.233,27" },
        { descricao: "MULTIVISÃO - PF - CAROÇO", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 28.188,02" },
        { descricao: "RESTAMP", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 30.450,00" },
        { descricao: "ACM FIBRAS", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 55.290,60" },
        { descricao: "ARAUCO", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 92.903,78" },
        { descricao: "CONTHEY", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 35.747,73" },
        { descricao: "BIGFER MATRIZ", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 516,00" },
        { descricao: "MULTIVISAO INDUSTRIA E COMERCIO LTDA", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 44.642,21" },
        { descricao: "ABC SPEEDY WAY TURISMO E TRANSPORTE LTDA", categoria: "TRANSPORTADORA", dataPagamento: "27/03/2025", valorPago: "R$ 5.963,86" },
        { descricao: "INDUSLOG SERVICOS DE LOGISTICA LTDA", categoria: "DESPESA FIXA", dataPagamento: "27/03/2025", valorPago: "R$ 8.965,06" },
        { descricao: "PER MOBILI", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 3.358,00" },
        { descricao: "ARAUCO - ACLUB", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 79.186,62" },
        { descricao: "ARAUCO - ACLUB", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 92.903,78" },
        { descricao: "VPLASTIC", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 2.095,98" },
        { descricao: "RESTAMP", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 100.900,00" },
        { descricao: "ZAGA TRANS", categoria: "TRANSPORTADORA", dataPagamento: "27/03/2025", valorPago: "R$ 3.800,00" },
        { descricao: "MULTIVISÃO - OF LETS", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 4.788,22" },
        { descricao: "MULTIVISÃO - PF - CAROÇO", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 41.719,94" },
        { descricao: "FERGRAFPLASTIC", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 16.695,00" },
        { descricao: "METALURGICA ALBRAS LTDA", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 10.876,32" },
        { descricao: "VPLASTIC", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 7.528,69" },
        { descricao: "COMISSIONAMENTO EFES", categoria: "IMPOSTO", dataPagamento: "28/03/2025", valorPago: "R$ 70.000,00" },
        { descricao: "MARCO ANTÔNIO", categoria: "RETIRADA", dataPagamento: "28/03/2025", valorPago: "R$ 30.000,00" },
        { descricao: "MULTIVISÃO - OF LETS", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 2.590,00" },
        { descricao: "MULTIVISÃO - OF LETS", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 5.299,76" },
        { descricao: "MULTIVISÃO - PF - CAROÇO", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 68.757,60" }
      ];

      // --------------------------------------------------------------------
      // 3) Funções de parsing (valor e data)
      // --------------------------------------------------------------------
      function parseValorBR(valorBR) {
        // Ex: "R$ 28.478,55" -> 28478.55
        return parseFloat(
          valorBR
            .replace("R$", "")
            .replace(/\./g, "")
            .replace(",", ".")
            .trim()
        );
      }

      function toISODate(strBR) {
        // "DD/MM/AAAA" -> "AAAA-MM-DD"
        const [dia, mes, ano] = strBR.split("/");
        return `${ano}-${mes}-${dia}`;
      }

      // --------------------------------------------------------------------
      // 4) Agrupamento dos dados por data
      //    (Somando tudo, independente de categoria)
      // --------------------------------------------------------------------
      const somaPorData = {};

      dados.forEach(item => {
        const dataISO = toISODate(item.dataPagamento); 
        const valorNum = parseValorBR(item.valorPago);

        if (!somaPorData[dataISO]) {
          somaPorData[dataISO] = 0;
        }
        somaPorData[dataISO] += valorNum;
      });

      // Transforma em array ordenado por data
      // Formato para ApexCharts: [ { x: (timestamp), y: (valor) }, ... ]
      const seriesData = Object.keys(somaPorData)
        .sort() // ordena cronologicamente
        .map(dataISO => {
          // Para o eixo X, podemos usar getTime() ou manter string "2025-03-24"
          // ApexCharts aceita ambos. Aqui usaremos getTime() para datetime.
          const dateObj = new Date(dataISO); 
          return {
            x: dateObj.getTime(),
            y: somaPorData[dataISO]
          };
        });

      // --------------------------------------------------------------------
      // 5) Configurar e renderizar o gráfico
      // --------------------------------------------------------------------
      const options = {
        chart: {
          type: 'bar',
          height: 500
        },
        series: [
          {
            name: 'Valor Pago',
            data: seriesData
          }
        ],
        xaxis: {
          type: 'datetime',
          // Formato no tooltip/labels
          labels: {
            datetimeUTC: false, // Para não ajustar fuso
            format: 'dd/MM/yyyy'
          }
        },
        yaxis: {
          labels: {
            // Formata valores no eixo Y em moeda BR
            formatter: (val) => {
              return val.toLocaleString('pt-BR', {
                minimumFractionDigits: 2
              });
            }
          }
        },
        tooltip: {
          x: {
            format: 'dd/MM/yyyy'
          },
          y: {
            formatter: (val) => {
              return val.toLocaleString('pt-BR', {
                style: 'currency',
                currency: 'BRL'
              });
            }
          }
        },
        title: {
          text: 'Total de Pagamentos por Data',
          align: 'left',
          style: {
            fontSize: '18px'
          }
        }
      };

      const chart = new ApexCharts(document.querySelector("#chart"), options);
      chart.render();
    </script>
  </body>
</html>
