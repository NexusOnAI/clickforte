<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Previsão Próximos Dias</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- ApexCharts JS -->
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  <style>
    /* Responsividade do gráfico */
    #chart {
      max-width: 100%;
      margin: 0 auto;
    }
    body {
      background-color: #fff;
      color: #212529;
    }
  </style>
</head>
<body>
  <div class="container my-5">
    <h2 class="text-center mb-4">Previsão de Gastos para os Próximos Dias (25/03 a 31/03)</h2>
    <div id="chart"></div>
    <!-- Local onde exibiremos o total geral -->
    <h4 class="text-center mt-4" id="totalGeral"></h4>
  </div>
  
  <script>
    // Lista de dados SOMENTE dos dias 25/03/2025 a 31/03/2025
    const dadosProximosDias = [
      // 25/03/2025
      { descricao: "PINHEIRO COMERCIO DE PAPEIS E EMBALAGENS LTDA", categoria: "FORNECEDOR", dataPagamento: "25/03/2025", valorPago: "R$ 281,60" },
      { descricao: "XPTO ADMINISTRADORA DE BENS PROPRIOS LTDA", categoria: "DESPESA FIXA", dataPagamento: "25/03/2025", valorPago: "R$ 250,00" },
      { descricao: "ALUGUEL GIRUS 902 - MARCO ANTÔNIO", categoria: "DESPESA FIXA", dataPagamento: "25/03/2025", valorPago: "R$ 7.500,00" },
      { descricao: "ALUGUEL GIRUS  903 - LUCIANA BALAGUER", categoria: "DESPESA FIXA", dataPagamento: "25/03/2025", valorPago: "R$ 14.073,65" },
      { descricao: "ALUGUEL GIRUS  919 - VERA BALAGUER", categoria: "DESPESA FIXA", dataPagamento: "25/03/2025", valorPago: "R$ 14.073,65" },
      { descricao: "ARAUCO", categoria: "FORNECEDOR", dataPagamento: "25/03/2025", valorPago: "R$ 92.903,78" },
      { descricao: "ARAUCO", categoria: "FORNECEDOR", dataPagamento: "25/03/2025", valorPago: "R$ 113.238,35" },
      { descricao: "ISS - MADEIRA EXPRESS", categoria: "IMPOSTO", dataPagamento: "25/03/2025", valorPago: "R$ 1.891,86" },
      { descricao: "PRD_IMD NAVEGANTES", categoria: "FORNECEDOR", dataPagamento: "25/03/2025", valorPago: "R$ 29.000,00" },
      { descricao: "PAPAI NOEL", categoria: "IMPOSTO", dataPagamento: "25/03/2025", valorPago: "R$ 50.000,00" },
      { descricao: "CARLOS BALLOTIN", categoria: "RETIRADA", dataPagamento: "25/03/2025", valorPago: "R$ 50.000,00" },
      { descricao: "MARCELO ANTUNES", categoria: "RETIRADA", dataPagamento: "25/03/2025", valorPago: "R$ 50.000,00" },

      // 26/03/2025
      { descricao: "MULTIVISÃO", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 3.233,27" },
      { descricao: "CAROÇO", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 28.188,02" },
      { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 24.532,41" },
      { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 24.532,41" },
      { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 24.532,41" },
      { descricao: "RESTAMP", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 30.450,00" },
      { descricao: "ACM FIBRAS", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 55.290,60" },
      { descricao: "ARAUCO", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 92.903,78" },
      { descricao: "CONTHEY", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 35.747,73" },
      { descricao: "BIGFER MATRIZ", categoria: "FORNECEDOR", dataPagamento: "26/03/2025", valorPago: "R$ 516,00" },

      // 27/03/2025
      { descricao: "MULTIVISAO INDUSTRIA E COMERCIO LTDA", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 44.642,21" },
      { descricao: "ABC SPEEDY WAY TURISMO E TRANSPORTE LTDA", categoria: "TRANSPORTADORA", dataPagamento: "27/03/2025", valorPago: "R$ 5.963,86" },
      { descricao: "INDUSLOG SERVICOS DE LOGISTICA LTDA", categoria: "DESPESA FIXA", dataPagamento: "27/03/2025", valorPago: "R$ 8.965,06" },
      { descricao: "PER MOBILI", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 3.358,00" },
      { descricao: "ARAUCO - ACLUB", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 79.186,62" },
      { descricao: "ARAUCO - ACLUB", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 92.903,78" },
      { descricao: "VPLASTIC", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 2.095,98" },
      { descricao: "RESTAMP", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 100.900,00" },
      { descricao: "ZAGA TRANS", categoria: "TRANSPORTADORA", dataPagamento: "27/03/2025", valorPago: "R$ 3.800,00" },
      { descricao: "MULTIVISÃO", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 4.788,22" },
      { descricao: "CAROÇO", categoria: "FORNECEDOR", dataPagamento: "27/03/2025", valorPago: "R$ 41.719,94" },

      // 28/03/2025
      { descricao: "FERGRAFPLASTIC", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 16.695,00" },
      { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 24.998,21" },
      { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 24.998,21" },
      { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 24.998,21" },
      { descricao: "METALURGICA ALBRAS LTDA", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 10.876,32" },
      { descricao: "VPLASTIC", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 7.528,69" },
      { descricao: "COMISSIONAMENTO EFES", categoria: "IMPOSTO", dataPagamento: "28/03/2025", valorPago: "R$ 70.000,00" },
      { descricao: "MARCO ANTÔNIO", categoria: "RETIRADA", dataPagamento: "28/03/2025", valorPago: "R$ 30.000,00" },
      { descricao: "MULTIVISÃO", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 2.590,00" },
      { descricao: "MULTIVISÃO", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 5.299,76" },
      { descricao: "CAROÇO", categoria: "FORNECEDOR", dataPagamento: "28/03/2025", valorPago: "R$ 68.757,60" },

      // 29/03/2025
      { descricao: "BIGFER INDUSTRIA E C", categoria: "FORNECEDOR", dataPagamento: "29/03/2025", valorPago: "R$ 1.459,05" },
      { descricao: "MULTIVISAO INDUSTRIA E COMERCIO LTDA", categoria: "FORNECEDOR", dataPagamento: "29/03/2025", valorPago: "R$ 40.732,34" },

      // 30/03/2025
      { descricao: "CAROÇO", categoria: "FORNECEDOR", dataPagamento: "30/03/2025", valorPago: "R$ 17.369,27" },
      { descricao: "ALINE MARIE", categoria: "DESPESA FIXA", dataPagamento: "30/03/2025", valorPago: "R$ 1.000,00" },
      { descricao: "ARAUCO PREVISAO", categoria: "FORNECEDOR", dataPagamento: "30/03/2025", valorPago: "R$ 370.000,00" },

      // 31/03/2025
      { descricao: "ARAUCO - ACLUB", categoria: "FORNECEDOR", dataPagamento: "31/03/2025", valorPago: "R$ 79.186,62" },
      { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "31/03/2025", valorPago: "R$ 24.532,41" },
      { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "31/03/2025", valorPago: "R$ 24.532,41" },
      { descricao: "EUCATEX RAFA", categoria: "FORNECEDOR", dataPagamento: "31/03/2025", valorPago: "R$ 24.532,41" }
    ];

    // Função para converter valor "R$ X" em número
    function parseValorBR(valorBR) {
      return parseFloat(valorBR.replace("R$", "").replace(/\./g, "").replace(",", ".").trim());
    }

    // Função para converter data "DD/MM/AAAA" em formato ISO "AAAA-MM-DD"
    function toISODate(strBR) {
      const [dia, mes, ano] = strBR.split("/");
      return `${ano}-${mes}-${dia}`;
    }

    // Agrupar valores por data
    const somaPorData = {};
    dadosProximosDias.forEach(item => {
      const dataISO = toISODate(item.dataPagamento);
      const valorNum = parseValorBR(item.valorPago);
      if (!somaPorData[dataISO]) {
        somaPorData[dataISO] = 0;
      }
      somaPorData[dataISO] += valorNum;
    });

    // Converter em formato para ApexCharts [{ x: timestamp, y: valor }, ...]
    const seriesData = Object.keys(somaPorData)
      .sort()
      .map(dataISO => ({
        x: new Date(dataISO).getTime(),
        y: somaPorData[dataISO]
      }));

    // Calcular o total geral (soma de todos os dias)
    const totalGeral = Object.values(somaPorData).reduce((acc, val) => acc + val, 0);

    /*******************************************************************
     *             CONFIGURAÇÃO DO GRÁFICO (ESTILO SEMELHANTE)
     *******************************************************************/
    var options = {
      chart: {
        type: 'bar',
        height: 350,
        background: 'transparent',
        toolbar: { show: false }
      },
      plotOptions: {
        bar: {
          borderRadius: 8,
          horizontal: false,
          columnWidth: '50%',
          dataLabels: { position: 'top' }
        }
      },
      dataLabels: {
        enabled: true,
        formatter: function(val) {
          return "R$ " + val.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        },
        offsetY: -20,
        style: {
          fontSize: '12px',
          colors: ["#000"]
        }
      },
      series: [{
        name: 'Valor Total',
        data: seriesData
      }],
      xaxis: {
        type: 'datetime',
        labels: {
          format: 'dd/MM',
          style: {
            fontSize: '14px',
            colors: ["#000"]
          }
        },
        axisBorder: { show: false },
        axisTicks: { show: false }
      },
      yaxis: {
        labels: {
          formatter: function(val) {
            return "R$ " + val.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
          },
          style: {
            fontSize: '12px',
            colors: ["#000"]
          }
        },
        title: {
          text: 'Valor Pago'
        }
      },
      fill: {
        type: 'gradient',
        gradient: {
          shade: 'light',
          type: "vertical",
          shadeIntensity: 0.3,
          opacityFrom: 0.85,
          opacityTo: 0.85,
          stops: [0, 90, 100]
        }
      },
      tooltip: {
        theme: 'light',
        x: {
          format: 'dd/MM/yyyy'
        },
        y: {
          formatter: function(val) {
            return "R$ " + val.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
          }
        }
      },
      responsive: [
        {
          breakpoint: 768,
          options: {
            chart: { height: 300 },
            plotOptions: { bar: { columnWidth: '70%' } },
            dataLabels: { style: { fontSize: '10px' } },
            xaxis: { labels: { style: { fontSize: '12px' } } },
            yaxis: { labels: { style: { fontSize: '10px' } } }
          }
        },
        {
          breakpoint: 576,
          options: {
            chart: { height: 250 },
            plotOptions: { bar: { columnWidth: '80%' } },
            dataLabels: { style: { fontSize: '8px' } },
            xaxis: { labels: { style: { fontSize: '10px' } } },
            yaxis: { labels: { style: { fontSize: '8px' } } }
          }
        }
      ]
    };

    var chart = new ApexCharts(document.querySelector("#chart"), options);
    chart.render();

    // Exibir o total geral formatado no elemento #totalGeral
    document.getElementById('totalGeral').textContent =
      "Total Geral: R$ " + totalGeral.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
  </script>

  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
