<!DOCTYPE html>
<html lang="pt-br" data-bs-theme="dark"> <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard Avançado de Gastos (Dark)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  <style>
    /* Definição de variáveis de cor - Apenas Dark Mode */
    :root {
      --bs-body-font-family: 'Inter', sans-serif;
      --theme-bg: #1a1d21;
      --theme-text: #e9ecef;
      --theme-card-bg: #212529;
      --theme-card-border: #495057;
      --theme-card-header-bg: #343a40;
      --theme-muted-text: #adb5bd;
      --theme-primary-color: #4dabf7; /* Azul vibrante para dark mode */
      --theme-primary-gradient-start: rgba(77, 171, 247, 0.35);
      --theme-primary-gradient-end: rgba(77, 171, 247, 0.01);
      --theme-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
      color-scheme: dark; /* Sinaliza preferência dark */
    }

    /* Removido o bloco [data-bs-theme="dark"] */

    body {
      background-color: var(--theme-bg);
      color: var(--theme-text);
      /* Removida transição desnecessária */
      font-family: var(--bs-body-font-family);
    }

    .dashboard-header {
      display: flex;
      justify-content: space-between; /* Mantido caso adicione outros itens */
      align-items: center;
      margin-bottom: 2.5rem;
    }

    .dashboard-title {
      color: var(--theme-primary-color);
      font-weight: 700;
      margin: 0;
    }

    .chart-card, .kpi-card {
      background-color: var(--theme-card-bg);
      border: 1px solid var(--theme-card-border);
      border-radius: 0.75rem;
      box-shadow: var(--theme-shadow);
      margin-bottom: 1.5rem;
      /* Removida transição desnecessária */
      overflow: hidden;
    }

    .card-header {
      background-color: var(--theme-card-header-bg);
      border-bottom: 1px solid var(--theme-card-border);
      font-weight: 600;
      font-size: 0.95rem;
      padding: 0.75rem 1.25rem;
      /* Removida transição desnecessária */
      color: var(--theme-text);
    }

    .card-body {
       padding: 1.25rem;
    }

    .kpi-card .card-body {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
    }

    .kpi-title {
        font-size: 0.9rem;
        font-weight: 500;
        color: var(--theme-muted-text);
        margin-bottom: 0.5rem;
    }

    .kpi-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--theme-primary-color);
    }

    /* Removidos estilos para o botão de tema */

    /* Ajustes finos nos gráficos ApexCharts (herdam cores dark) */
    .apexcharts-tooltip {
      background: var(--theme-card-bg) !important;
      color: var(--theme-text) !important;
      border: 1px solid var(--theme-card-border) !important;
    }
    .apexcharts-tooltip .apexcharts-tooltip-title {
      background: var(--theme-card-header-bg) !important;
      border-bottom: 1px solid var(--theme-card-border) !important;
      color: var(--theme-text) !important;
    }
    .apexcharts-xaxis-label, .apexcharts-yaxis-label {
        fill: var(--theme-muted-text) !important;
        font-family: var(--bs-body-font-family) !important;
    }
     .apexcharts-legend-text {
         color: var(--theme-muted-text) !important;
         font-family: var(--bs-body-font-family) !important;
     }

    /* Responsividade (mantida) */
    @media (max-width: 768px) {
      .dashboard-header {
          flex-direction: column;
          align-items: flex-start;
          margin-bottom: 1.5rem;
      }
       .dashboard-title {
          margin-bottom: 0.5rem;
      }
      .kpi-value {
          font-size: 1.75rem;
      }
    }
  </style>
</head>
<body>
  <div class="container my-4 my-md-5">
    <div class="dashboard-header">
      <h1 class="dashboard-title">Dashboard Avançado de Gastos</h1>
      </div>

    <div class="row">
        <div class="col-12 col-md-4 col-lg-3">
             <div class="kpi-card">
                <div class="card-body">
                    <div class="kpi-title">Gasto Total (Trimestre)</div>
                    <div class="kpi-value" id="kpi-total-geral">R$ 0,00</div>
                </div>
            </div>
        </div>

         <div class="col-12 col-md-8 col-lg-9">
             <div class="chart-card">
                <div class="card-header text-center">
                    Evolução Mensal dos Gastos
                </div>
                <div class="card-body">
                    <div id="chartMensal"></div>
                </div>
            </div>
         </div>
    </div>


    <div class="row">
      <div class="col-lg-4 col-md-6">
        <div class="chart-card">
          <div class="card-header text-center">
            Gastos Semanais - Janeiro
          </div>
          <div class="card-body">
            <div id="chartSemanalJaneiro"></div>
          </div>
        </div>
      </div>

      <div class="col-lg-4 col-md-6">
        <div class="chart-card">
          <div class="card-header text-center">
            Gastos Semanais - Fevereiro
          </div>
          <div class="card-body">
            <div id="chartSemanalFevereiro"></div>
          </div>
        </div>
      </div>

      <div class="col-lg-4 col-md-12">
        <div class="chart-card">
          <div class="card-header text-center">
            Gastos Semanais - Março
          </div>
          <div class="card-body">
            <div id="chartSemanalMarco"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===================================================================
    // FUNÇÃO AUXILIAR PARA CRIAR OPÇÕES DO GRÁFICO DE ÁREA (DARK MODE FIXO)
    // ===================================================================
    /**
     * Cria um objeto de configuração padrão para os gráficos de área ApexCharts (Tema Dark Fixo).
     * @param {string} chartId - O ID do elemento HTML onde o gráfico será renderizado.
     * @param {Array<number>} seriesData - Array com os dados da série do gráfico.
     * @param {Array<string>} categories - Array com as categorias do eixo X.
     * @param {string} seriesName - Nome da série de dados (para tooltip e legenda).
     * @param {number} chartHeight - Altura do gráfico.
     * @returns {object} Objeto de configuração para ApexCharts.
     */
    function createAreaChartOptions(chartId, seriesData, categories, seriesName = 'Valor', chartHeight = 300) {
      const formatCurrency = (val) => {
        if (val === null || val === undefined) return "R$ 0,00";
        return "R$ " + val.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      };

      // Cores definidas diretamente para Dark Mode ou via variáveis CSS
      const primaryColor = 'var(--theme-primary-color)'; // Usa a variável CSS
      const gridColor = '#404040'; // Cor da grade específica
      const cardBgColor = 'var(--theme-card-bg)'; // Usa a variável CSS

      return {
        chart: {
          id: chartId,
          type: 'area',
          height: chartHeight,
          background: 'transparent',
          toolbar: { show: true, tools: { download: true, selection: false, zoom: false, zoomin: false, zoomout: false, pan: false, reset: false } },
          fontFamily: 'Inter, sans-serif',
          zoom: { enabled: false },
          animations: {
             enabled: true,
             easing: 'easeinout',
             speed: 800,
             animateGradually: { enabled: true, delay: 150 },
             dynamicAnimation: { enabled: true, speed: 350 }
          }
        },
        dataLabels: {
          enabled: false
        },
        stroke: {
          curve: 'smooth',
          width: 2.5
        },
        fill: {
          type: 'gradient',
          gradient: {
            shadeIntensity: 1,
            opacityFrom: 0.6,
            opacityTo: 0.1,
            stops: [0, 95, 100]
          },
           colors: [primaryColor] // Cor base do gradiente
        },
        colors: [primaryColor], // Cor principal da série
        series: [{
          name: seriesName,
          data: seriesData
        }],
        xaxis: {
          categories: categories,
          labels: {
            style: {
              fontSize: '12px'
              // Cor definida via CSS
            }
          },
          axisBorder: { show: false },
          axisTicks: { show: false }
        },
        yaxis: {
          labels: {
            formatter: formatCurrency,
            style: {
              fontSize: '11px'
              // Cor definida via CSS
            }
          }
        },
        tooltip: {
          theme: 'dark', // Fixo como dark
          y: {
            formatter: formatCurrency
          }
        },
        grid: {
          show: true,
          borderColor: gridColor, // Cor da grade para dark
          strokeDashArray: 4,
          yaxis: { lines: { show: true } },
          xaxis: { lines: { show: false } }
        },
        theme: {
            mode: 'dark' // Fixo como dark
        },
         markers: {
            size: 4,
            colors: [primaryColor],
            strokeColors: cardBgColor, // Usa a cor de fundo do card
            strokeWidth: 2,
            hover: {
                size: 6
            }
        },
        responsive: [ // Mantido
          {
            breakpoint: 992,
            options: { chart: { height: chartHeight * 0.9 } }
          },
          {
            breakpoint: 768,
            options: {
                chart: { height: chartHeight * 0.85 },
                stroke: { width: 2 },
                markers: { size: 3, hover: { size: 5 } }
             }
          },
           {
            breakpoint: 576,
            options: {
                chart: { height: chartHeight * 0.8 },
                 markers: { size: 0, hover: { size: 0 } },
                 yaxis: { labels: { show: false } }
            }
          }
        ]
      };
    }

    // ===================================================================
    // DADOS E RENDERIZAÇÃO INICIAL (SIMPLIFICADO)
    // ===================================================================
    const valorJaneiro = 5686819.08;
    const valorFevereiro = 6105182.26;
    const valorMarco = 6995663.47;
    const valorTotal = valorJaneiro + valorFevereiro + valorMarco;

    const dadosMensal = [valorJaneiro, valorFevereiro, valorMarco];
    const categoriasMensal = ['Janeiro', 'Fevereiro', 'Março'];

    const dadosSemanasJaneiro = [1059106.09, 1390876.49, 1356479.34, 1880357.16];
    const dadosSemanasFev = [1347844.70, 1351449.96, 1707533.26, 1698354.34];
    const dadosSemanasMarco = [1516175.78, 1634234.11, 1343905.08, 2501348.50];
    const categoriasSemanas = ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4'];

    // Removida lógica de tema e atualização

    // --- Define o KPI Total Geral ---
    document.getElementById('kpi-total-geral').textContent = "R$ " + valorTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });

    // --- Renderiza os gráficos diretamente ---
    const optionsMensal = createAreaChartOptions('chartMensal', dadosMensal, categoriasMensal, 'Gasto Mensal', 350);
    const chartMensal = new ApexCharts(document.querySelector("#chartMensal"), optionsMensal);
    chartMensal.render();

    const optionsSemanalJaneiro = createAreaChartOptions('chartSemanalJaneiro', dadosSemanasJaneiro, categoriasSemanas, 'Gasto Semanal', 300);
    const chartSemanalJaneiro = new ApexCharts(document.querySelector("#chartSemanalJaneiro"), optionsSemanalJaneiro);
    chartSemanalJaneiro.render();

    const optionsSemanalFev = createAreaChartOptions('chartSemanalFevereiro', dadosSemanasFev, categoriasSemanas, 'Gasto Semanal', 300);
    const chartSemanalFev = new ApexCharts(document.querySelector("#chartSemanalFevereiro"), optionsSemanalFev);
    chartSemanalFev.render();

    const optionsSemanalMarco = createAreaChartOptions('chartSemanalMarco', dadosSemanasMarco, categoriasSemanas, 'Gasto Semanal', 300);
    const chartSemanalMarco = new ApexCharts(document.querySelector("#chartSemanalMarco"), optionsSemanalMarco);
    chartSemanalMarco.render();

    // Removido Event Listener do botão de tema e detecção de tema do sistema

  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>
